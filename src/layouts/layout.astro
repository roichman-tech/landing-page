---
import '@/styles/global.css';

import Analytics from '@vercel/analytics/astro'

import type {
  AlternateLink,
  FooterContent,
  HeaderContent,
  MetaContent,
} from '@/app/i18n/home';

import { Footer } from '@/view/layouts/footer';
import { Header } from '@/view/layouts/header';

interface LayoutProps {
  lang?: string;
  meta?: MetaContent;
  header?: HeaderContent;
  footer?: FooterContent;
}

const defaultMeta: MetaContent = {
  title:
    'Roichman Tech | Software House - Desenvolvimento de Software Sob Medida',
  description:
    'Desenvolvemos software sob medida com foco em qualidade, prazos e resultados de longo prazo. Sistemas web, apps mobile, integrações e mais.',
  ogTitle: 'Roichman Tech | Software House',
  ogDescription:
    'Desenvolvemos software sob medida com foco em qualidade, prazos e resultados de longo prazo.',
  twitterTitle: 'Roichman Tech | Software House',
  twitterDescription:
    'Desenvolvemos software sob medida com foco em qualidade, prazos e resultados de longo prazo.',
};

const {
  lang = 'pt-BR',
  meta = defaultMeta,
  header,
  footer,
} = Astro.props as LayoutProps;

const resolvedMeta = {
  ...defaultMeta,
  ...meta,
  ogTitle: meta.ogTitle ?? meta.title,
  ogDescription: meta.ogDescription ?? meta.description,
  twitterTitle: meta.twitterTitle ?? meta.title,
  twitterDescription: meta.twitterDescription ?? meta.description,
};

const headerProps =
  header ??
  ({
    navLinks: [],
    ctaHref: '#',
    ctaLabel: '',
    languageSwitch: { label: '', href: '/', ariaLabel: '', flag: 'br' },
    menuLabel: 'Menu',
  } satisfies HeaderContent);

const footerProps =
  footer ??
  ({
    tagline: 'Roichman Tech',
    location: '',
    contactHeading: 'Contato',
    rights: 'Roichman Tech',
  } satisfies FooterContent);
---

<!DOCTYPE html>
<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{resolvedMeta.title}</title>
    <meta name="description" content={resolvedMeta.description} />
    <meta name="author" content="Roichman Tech" />
    <meta name="theme-color" content="#0070b8" />

    <meta property="og:title" content={resolvedMeta.ogTitle} />
    <meta property="og:description" content={resolvedMeta.ogDescription} />
    <meta property="og:type" content="website" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={resolvedMeta.twitterTitle} />
    <meta name="twitter:description" content={resolvedMeta.twitterDescription} />

    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="preload" href="/fonts/inter-variable.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="preload" href="/fonts/sora-variable.ttf" as="font" type="font/ttf" crossorigin>
    <link
      rel="preload"
      as="image"
      href="/images/logo.webp"
      imagesizes="(min-width: 768px) 168px, 134px"
      fetchpriority="high"
      crossorigin
    />

    <link rel="alternate" hreflang="pt" href="https://roichman.tech" />
    <link rel="alternate" hreflang="en" href="https://roichman.tech/en" />
  </head>
  <body class="bg-background text-foreground font-sans antialiased">
    <Header content={headerProps} client:load />

    <main>
      <slot />
    </main>

    <Footer content={footerProps} />

    <Analytics />
  </body>
</html>
